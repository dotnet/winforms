# All variables in this yml are defined in ../.vsts-ci.yml.
parameters:

  # Needed because agent pool can't be read from agent-scoped variables
  agentPool: ''

  # needed to reference variables defined in the caller
  variables: {}

phases:
- template: /eng/build.yml
  parameters:
  
    # insert the variables from the caller as local variables
    variables:
      ${{ insert }}: ${{ parameters.variables }}

    name: Windows_NT
    runAsPublic: ${{ variables['_RunAsPublic'] }}
    queue:
      name: ${{ parameters.agentPool }}
      parallel: 99
      matrix:
        Build_Debug:
          _BuildConfig: netcoreapp-Windows_NT-Debug
          _PublishType: none
          _SignType: test
          _DotNetPublishToBlobFeed : false
        Build_Release:
          _BuildConfig: netcoreapp-Windows_NT-Release

- ${{ if eq(parameters.runAsPublic, 'false') }}:
  - template: /eng/common/templates/phases/publish-build-assets.yml
    parameters:
      dependsOn: Windows_NT
      queue:
        name: Hosted VS2017
      configuration: netcoreapp-Windows_NT-Debug