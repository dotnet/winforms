<Project Sdk="Microsoft.Build.NoTargets/3.6.0">
  <!--
    We cannot build Framework projects using dotnet build when there are unsupported tasks involved such as ResolveComReferences.
    This project is an adapter to use the Framework version of msbuild from dotnet build.
  -->
  <PropertyGroup>
    <_AxHostsPath>$([MSBuild]::NormalizePath('$(MSBuildProjectDirectory)', '..', 'System.Windows.Forms', 'tests', 'AxHosts', 'AxHosts.csproj'))</_AxHostsPath>
    <_ProjectArgs>/p:Configuration=$(Configuration) /p:Platform=AnyCPU</_ProjectArgs>
  </PropertyGroup>

  <Target Name="BuildAxHosts" BeforeTargets="AfterBuild;FindFrameworkMsBuild">
    <Exec Command="msbuild.exe $(_AxHostsPath) $(_ProjectArgs)"
          WorkingDirectory="$(VSINSTALLDIR)\MSBuild\Current\Bin\amd64"/>
  </Target>

  <Target Name="CleanAxHosts" BeforeTargets="AfterClean;FindFrameworkMsBuild">
    <Exec Command="msbuild.exe $(_AxHostsPath) $(_ProjectArgs) /t:Clean"
          WorkingDirectory="$(VSINSTALLDIR)\MSBuild\Current\Bin\amd64"/>
  </Target>
</Project>